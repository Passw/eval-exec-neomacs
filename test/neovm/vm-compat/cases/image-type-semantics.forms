(fboundp 'image-type)
(fboundp 'image-type-available-p)

(image-type-available-p 'neomacs)

(condition-case err
    (image-type (create-image "x" 'pbm t))
  (error (car err)))
(image-type "foo.jpg")
(condition-case err
    (image-type "foo.unknown")
  (error (car err)))
(image-type "noext" 'png nil)
(condition-case err
    (image-type "raw" nil 'image/jpeg)
  (error (car err)))

(condition-case err
    (image-type 42)
  (error (car err)))
(condition-case err
    (image-type "x" 42 nil)
  (error (car err)))

(condition-case err
    (image-type)
  (error (car err)))
