; process-tty-name stream and process-kind compatibility semantics.
(mapcar (lambda (s)
          (list s
                (fboundp s)
                (subrp (symbol-function s))
                (subr-arity (symbol-function s))
                (commandp s)))
        '(process-tty-name make-pipe-process make-network-process))

(let ((p (start-process "proc-tty-kind-real" nil "cat")))
  (unwind-protect
      (let ((tty0 (process-tty-name p)))
        (list
         (stringp tty0)
         (equal tty0 (process-tty-name p nil))
         (stringp (process-tty-name p 'stdin))
         (stringp (process-tty-name p 'stdout))
         (stringp (process-tty-name p 'stderr))
         (equal (process-tty-name p 'stdin) (process-tty-name p 'stdout))
         (equal (process-tty-name p 'stdout) (process-tty-name p 'stderr))
         (delete-process p)
         (process-live-p p)
         (stringp (process-tty-name p))
         (equal tty0 (process-tty-name p))))
    (ignore-errors (delete-process p))))

(let ((p (make-pipe-process :name "proc-tty-kind-pipe")))
  (unwind-protect
      (list
       (null (process-tty-name p))
       (null (process-tty-name p nil))
       (null (process-tty-name p 'stdin))
       (null (process-tty-name p 'stdout))
       (null (process-tty-name p 'stderr))
       (delete-process p)
       (process-live-p p)
       (null (process-tty-name p))
       (null (process-tty-name p 'stdin)))
    (ignore-errors (delete-process p))))

(let ((p (make-network-process :name "proc-tty-kind-net" :server t :service 0)))
  (unwind-protect
      (list
       (null (process-tty-name p))
       (null (process-tty-name p nil))
       (null (process-tty-name p 'stdin))
       (null (process-tty-name p 'stdout))
       (null (process-tty-name p 'stderr))
       (delete-process p)
       (process-live-p p)
       (null (process-tty-name p))
       (null (process-tty-name p 'stderr)))
    (ignore-errors (delete-process p))))

(condition-case err
    (let ((p (make-pipe-process :name "proc-tty-kind-err")))
      (unwind-protect
          (process-tty-name p 'bogus)
        (ignore-errors (delete-process p))))
  (error err))
