(fboundp 'key-binding)
(subr-arity (symbol-function 'key-binding))

(let ((g (make-sparse-keymap)))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] 'forward-char)
  (list
   (key-binding (kbd "a"))
   (key-binding (kbd "a") t)
   (key-binding (kbd "a") t nil)
   (key-binding (kbd "a") t t)
   (key-binding (kbd "a") t nil nil)
   (key-binding (kbd "a") t t nil)
   (global-key-binding (kbd "a"))))

(let ((g (make-sparse-keymap))
      (m (make-sparse-keymap))
      (minor-mode-map-alist nil)
      (demo-mode t))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] 'forward-char)
  (define-key m [remap self-insert-command] 'backward-char)
  (setq minor-mode-map-alist (list (cons 'demo-mode m)))
  (list
   (key-binding (kbd "a"))
   (key-binding (kbd "a") t t)))

(let ((g (make-sparse-keymap)))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] t)
  (key-binding (kbd "a")))

(let ((g (make-sparse-keymap)))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] 1)
  (key-binding (kbd "a")))

(let ((g (make-sparse-keymap)))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] nil)
  (key-binding (kbd "a")))

(let ((g (make-sparse-keymap)))
  (use-global-map g)
  (define-key g (kbd "a") 'self-insert-command)
  (define-key g [remap self-insert-command] [x])
  (list
   (key-binding (kbd "a"))
   (key-binding (kbd "a") t t)
   (command-remapping 'self-insert-command)))
