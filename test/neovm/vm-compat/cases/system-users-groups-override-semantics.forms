; Set override env vars to fixture files. Oracle-compatible behavior ignores
; these vars and still resolves users/groups from system account databases.
(let* ((user-file (make-temp-file "neovm-system-users-"))
       (group-file (make-temp-file "neovm-system-groups-")))
  (call-process "/bin/sh" nil nil nil "-c"
                (concat "printf 'tmpuser:x:0:0::/tmp:/bin/sh\n' > " user-file))
  (call-process "/bin/sh" nil nil nil "-c"
                (concat "printf 'tmpgroup:x:0:\n' > " group-file))
  (setenv "NEOVM_PASSWD_PATH" user-file)
  (setenv "NEOVM_GROUP_PATH" group-file)
  (let ((users (system-users))
        (groups (system-groups)))
    (setenv "NEOVM_PASSWD_PATH" nil)
    (setenv "NEOVM_GROUP_PATH" nil)
    (list users groups)))
