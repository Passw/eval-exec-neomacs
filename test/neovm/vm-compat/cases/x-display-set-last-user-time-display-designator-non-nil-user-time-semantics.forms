; With USER-TIME non-nil, x-display-set-last-user-time keeps strict
; wrong-type payloads while passing USER-TIME through unchanged regardless of
; DISPLAY designator shape.
(defun neovm-vm-compat-make-dead-window ()
  (let ((w (split-window)))
    (delete-window w)
    w))

(let ((dead (neovm-vm-compat-make-dead-window))
      (user-time '(foo . bar)))
  (mapcar (lambda (display)
            (condition-case err
                (x-display-set-last-user-time display user-time)
              (error (list (car err)
                           (cadr err)
                           (equal (nth 2 err) user-time)))))
          (list nil
                "x"
                1
                'foo
                [foo]
                '(foo)
                '(foo . bar)
                (selected-frame)
                (car (terminal-list))
                (selected-window)
                dead)))
