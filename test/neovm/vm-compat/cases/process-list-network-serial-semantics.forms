; Process list/network/serial compatibility semantics.
(mapcar (lambda (s)
          (list s
                (fboundp s)
                (subrp (symbol-function s))
                (subr-arity (symbol-function s))
                (commandp s)))
        '(list-system-processes
          num-processors
          list-processes
          list-processes--refresh
          make-network-process
          make-pipe-process
          make-serial-process
          serial-process-configure
          set-network-process-option))

(list
 (listp (list-system-processes))
 (integerp (car (list-system-processes)))
 (not (null (member (emacs-pid) (list-system-processes))))
 (condition-case err (list-system-processes nil) (error err))
 (num-processors)
 (num-processors t)
 (condition-case err (num-processors 1 2) (error err))
 (list-processes)
 (list-processes nil)
 (list-processes t)
 (list-processes nil nil)
 (list-processes nil t)
 (condition-case err (list-processes nil nil nil) (error err))
 (listp (list-processes--refresh))
 (equal (car (list-processes--refresh)) "")
 (condition-case err (list-processes--refresh nil) (error err)))

(list
 (make-network-process)
 (condition-case err (make-network-process :name "np") (error err))
 (condition-case err (make-network-process :name 1) (error err))
 (condition-case err (make-network-process :service 80) (error err))
 (let ((p (make-network-process :name "np-server" :server t :service 0)))
   (unwind-protect
       (processp p)
     (ignore-errors (delete-process p))))
 (make-pipe-process)
 (let ((p (make-pipe-process :name "pp")))
   (unwind-protect
       (processp p)
     (ignore-errors (delete-process p))))
 (condition-case err (make-pipe-process :name 1) (error err))
 (make-serial-process)
 (condition-case err (make-serial-process :name "sp") (error err))
 (condition-case err (make-serial-process :name "sp" :port "/tmp/no-port") (error err))
 (with-temp-buffer
   (condition-case err (serial-process-configure) (error err)))
 (with-temp-buffer
   (let ((p (start-process "serial-cfg-proc" nil "cat")))
     (unwind-protect
         (condition-case err (serial-process-configure p) (error err))
       (ignore-errors (delete-process p)))))
 (condition-case err (set-network-process-option) (error err))
 (condition-case err (set-network-process-option 1 :foo 1) (error err))
 (let ((p (start-process "netopt-real" nil "cat")))
   (unwind-protect
       (condition-case err (set-network-process-option p :foo 1) (error err))
     (ignore-errors (delete-process p))))
 (let ((p (make-network-process :name "netopt-network" :server t :service 0)))
   (unwind-protect
       (set-network-process-option p :foo 1)
     (ignore-errors (delete-process p)))))
