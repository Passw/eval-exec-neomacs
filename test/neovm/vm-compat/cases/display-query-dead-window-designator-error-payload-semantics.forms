; Dead window designators should keep compact window-handle payload shape.
(defun neovm-vm-compat-make-dead-window ()
  (let ((w (split-window)))
    (delete-window w)
    w))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-graphic-p w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-color-p w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-pixel-width w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-pixel-height w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-mm-width w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-mm-height w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-screens w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-color-cells w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-planes w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-visual-class w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-backing-store w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))

(let ((w (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (display-images-p w)
    (error
     (let ((msg (error-message-string err)))
       (list (car err)
             (not (null (string-match-p "get-device-terminal" msg)))
             (not (null (string-match-p "#<window [0-9]+>" msg)))
             (not (null (string-match-p " on " msg))))))))
