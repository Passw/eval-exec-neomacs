; clear-this-command-keys clears this-command-keys* context and returns nil.

(fboundp 'clear-this-command-keys)
(commandp 'clear-this-command-keys)
(subr-arity (symbol-function 'clear-this-command-keys))

(list (this-command-keys) (this-command-keys-vector))

(let ((unread-command-events (list 97)))
  (read-event))
(list (this-command-keys) (this-command-keys-vector))

(progn
  (clear-this-command-keys)
  (list (this-command-keys) (this-command-keys-vector)))

(let ((unread-command-events (list 98)))
  (read-char nil nil nil))
(list (this-command-keys) (this-command-keys-vector))

(progn
  (clear-this-command-keys t)
  (list (this-command-keys) (this-command-keys-vector)))

(let ((unread-command-events (list 99)))
  (read-char-exclusive))
(this-command-keys-vector)
(clear-this-command-keys)
(this-command-keys-vector)

(let ((unread-command-events (list '(mouse-1))))
  (read-key nil))
(this-command-keys-vector)
(clear-this-command-keys 1)
(this-command-keys-vector)

; KEEP-RECORD controls recent-keys clearing.
(let ((unread-command-events (list 120)))
  (read-key nil))
(append (recent-keys) nil)
(progn
  (clear-this-command-keys)
  (append (recent-keys) nil))

(let ((unread-command-events (list 121)))
  (read-key nil))
(append (recent-keys) nil)
(progn
  (clear-this-command-keys t)
  (append (recent-keys) nil))

(let ((unread-command-events (list 122)))
  (read-key nil))
(append (recent-keys) nil)
(progn
  (clear-this-command-keys nil)
  (append (recent-keys) nil))

(condition-case err
    (clear-this-command-keys 1 2)
  (list (car err) (cdr err)))
