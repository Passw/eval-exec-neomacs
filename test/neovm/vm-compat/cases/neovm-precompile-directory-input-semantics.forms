; NeoVM extension policy: `neovm-precompile-file` rejects directory inputs.

(setq vm-precompile-dir-input "/tmp/neovm-precompile-dir-input")
(progn (ignore-errors (delete-directory vm-precompile-dir-input t)) (make-directory vm-precompile-dir-input t) 'ok)

(setq vm-precompile-dir-input-cache (concat vm-precompile-dir-input ".neoc"))

(condition-case err (neovm-precompile-file vm-precompile-dir-input) (error (car err)))
(let ((err (condition-case err (neovm-precompile-file vm-precompile-dir-input) (error err))))
  (and
   (eq (car err) 'file-error)
   (stringp (cadr err))
   (not (null (string-match-p "Cannot read source file for precompile" (cadr err))))
   (not (null (string-match-p "neovm-precompile-dir-input" (cadr err))))))
(file-exists-p vm-precompile-dir-input-cache)

(ignore-errors (delete-file vm-precompile-dir-input-cache))
(delete-directory vm-precompile-dir-input t)
