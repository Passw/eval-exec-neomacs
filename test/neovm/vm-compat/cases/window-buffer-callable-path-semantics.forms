(bufferp (funcall #'window-buffer nil))
(bufferp (apply #'window-buffer '(nil)))
(let ((fn (indirect-function 'window-buffer)))
  (bufferp (funcall fn nil)))
(condition-case err (funcall #'window-buffer nil nil) (error err))
(condition-case err (apply #'window-buffer '(nil nil)) (error err))
(condition-case err (funcall #'window-buffer 999999) (error err))
(condition-case err (apply #'window-buffer '(999999)) (error err))

(let* ((w (selected-window))
       (b (get-buffer-create "swb-callable-a")))
  (unwind-protect
      (progn
        (funcall #'set-window-buffer w b)
        (eq (window-buffer w) b))
    (when (buffer-live-p b)
      (kill-buffer b))))
(let* ((w (selected-window))
       (b (get-buffer-create "swb-callable-b")))
  (unwind-protect
      (progn
        (apply #'set-window-buffer (list w b))
        (eq (window-buffer w) b))
    (when (buffer-live-p b)
      (kill-buffer b))))
(let* ((setfn (indirect-function 'set-window-buffer))
       (w (selected-window))
       (b (get-buffer-create "swb-callable-c")))
  (unwind-protect
      (progn
        (funcall setfn w b)
        (eq (window-buffer w) b))
    (when (buffer-live-p b)
      (kill-buffer b))))

(condition-case err (funcall #'set-window-buffer nil) (error err))
(condition-case err (apply #'set-window-buffer '(nil)) (error err))
(condition-case err (funcall #'set-window-buffer nil "*scratch*" nil nil) (error err))
(condition-case err (apply #'set-window-buffer '(nil "*scratch*" nil nil)) (error err))
(condition-case err (funcall #'set-window-buffer 999999 "*scratch*") (error err))
(condition-case err (apply #'set-window-buffer '(999999 "*scratch*")) (error err))
(condition-case err (funcall #'set-window-buffer nil 1) (error err))
(condition-case err (apply #'set-window-buffer '(nil 1)) (error err))
(let ((b (generate-new-buffer "swb-callable-dead")))
  (kill-buffer b)
  (condition-case err (apply #'set-window-buffer (list nil b)) (error err)))
