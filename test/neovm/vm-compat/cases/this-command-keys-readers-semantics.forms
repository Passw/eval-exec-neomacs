(this-command-keys)
(this-command-keys-vector)
(progn (setq unread-command-events (list 97)) (read-key nil) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list 97)) (read-key-sequence "") (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list 97)) (read-key-sequence-vector "") (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list '(mouse-1))) (read-event nil nil 0) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list 97)) (read-key nil) (read-char nil nil 0) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list '(mouse-1))) (read-key nil) (condition-case _ (read-char nil nil 0) nil) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list '(mouse-1))) (read-key nil) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list 97)) (read-key nil) (read-char-exclusive nil nil 0) (list (this-command-keys) (this-command-keys-vector)))
(progn (setq unread-command-events (list '(mouse-1) 97)) (read-char-exclusive nil nil 0) (list (this-command-keys) (this-command-keys-vector)))

; Prompt/input readers in batch preserve prior this-command-keys state and do
; not publish queued unread events into this-command-keys*.
(let ((probes
       '((read-string "")
         (read-number "")
         (read-from-minibuffer "")
         (completing-read "" (("a") ("b")))
         (read-command "")
         (read-variable "")
         (read-buffer "")
         (read-file-name ""))))
  (mapcar
   (lambda (entry)
     (let ((fn (car entry))
           (args (cdr entry)))
       (condition-case _
           (progn
             (setq unread-command-events (list 97 'foo))
             (apply fn args))
         (error nil))
       (list fn (this-command-keys) (this-command-keys-vector))))
   probes))

(progn
  (setq unread-command-events (list '(mouse-1)))
  (read-key nil)
  (list 'seed (this-command-keys) (this-command-keys-vector)))

(let ((probes
       '((read-string "")
         (read-number "")
         (read-from-minibuffer "")
         (completing-read "" (("a") ("b")))
         (read-command "")
         (read-variable "")
         (read-buffer "")
         (read-file-name ""))))
  (mapcar
   (lambda (entry)
     (let ((fn (car entry))
           (args (cdr entry)))
       (condition-case _
           (progn
             (setq unread-command-events (list 97 'foo))
             (apply fn args))
         (error nil))
       (list fn (this-command-keys) (this-command-keys-vector))))
   probes))

(progn
  (setq unread-command-events (list 97))
  (read-key nil)
  (list 'reseed (this-command-keys) (this-command-keys-vector)))

(let ((probes
       '((read-string "")
         (read-number "")
         (read-from-minibuffer "")
         (completing-read "" (("a") ("b")))
         (read-command "")
         (read-variable "")
         (read-buffer "")
         (read-file-name ""))))
  (mapcar
   (lambda (entry)
     (let ((fn (car entry))
           (args (cdr entry)))
       (condition-case _
           (progn
             (setq unread-command-events (list '(mouse-1) 97))
             (apply fn args))
         (error nil))
       (list fn (this-command-keys) (this-command-keys-vector))))
   probes))
