(let ((ht (make-hash-table :test 'equal :size 3)))
  (puthash "a" 'value-a ht)
  (puthash "b" 'value-b ht)
  (let* ((buckets (internal--hash-table-buckets ht))
         (entries (apply #'append buckets))
         (a (assoc "a" entries))
         (b (assoc "b" entries)))
    (and (= 2 (length entries))
         (consp a)
         (consp b)
         (integerp (cdr a))
         (integerp (cdr b))
         (not (eq (cdr a) 'value-a))
         (not (eq (cdr b) 'value-b)))))

(let ((ht (make-hash-table :test 'equal :size 3)))
  (puthash "a" 'value-a ht)
  (puthash "b" 'value-b ht)
  (= 2
     (apply #'+
            (mapcar (lambda (pair) (* (car pair) (cdr pair)))
                    (internal--hash-table-histogram ht)))))
