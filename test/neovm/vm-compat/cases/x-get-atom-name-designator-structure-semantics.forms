(defun neovm-vm-compat-make-dead-window ()
  (let ((w (split-window (selected-window) nil 'below)))
    (delete-window w)
    w))
(condition-case err
    (x-get-atom-name 'WM_CLASS)
  (error (list (eq (car err) 'error)
               (equal (cadr err) "Window system frame should be used"))))
(condition-case err
    (x-get-atom-name 'WM_CLASS nil)
  (error (list (eq (car err) 'error)
               (equal (cadr err) "Window system frame should be used"))))
(condition-case err
    (x-get-atom-name 'WM_CLASS (selected-frame))
  (error (list (eq (car err) 'error)
               (equal (cadr err) "Window system frame should be used"))))
(let ((arg "x"))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (equal (nth 2 err) arg)))))
(let ((arg 1))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (equal (nth 2 err) arg)))))
(let ((arg 'foo))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (eq (nth 2 err) arg)))))
(let ((arg [foo]))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (equal (nth 2 err) arg)))))
(let ((arg '(foo)))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (equal (nth 2 err) arg)))))
(let ((arg '(foo . bar)))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (equal (nth 2 err) arg)))))
(let ((arg (car (terminal-list))))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (terminalp (nth 2 err))))))
(let ((arg (selected-window)))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (windowp (nth 2 err))
                 (window-live-p (nth 2 err))))))
(let ((arg (neovm-vm-compat-make-dead-window)))
  (condition-case err
      (x-get-atom-name 'WM_CLASS arg)
    (error (list (eq (car err) 'wrong-type-argument)
                 (eq (cadr err) 'frame-live-p)
                 (windowp (nth 2 err))
                 (not (window-live-p (nth 2 err)))))))
(condition-case err
    (x-get-atom-name)
  (error err))
(condition-case err
    (x-get-atom-name 'WM_CLASS nil nil)
  (error err))
