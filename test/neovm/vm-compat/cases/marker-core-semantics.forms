; marker.c â€” marker operations
; make-marker
(markerp (make-marker))
(eq (marker-position (make-marker)) nil)
(eq (marker-buffer (make-marker)) nil)

; set-marker / marker-position
(with-temp-buffer
  (insert "hello")
  (let ((m (make-marker)))
    (set-marker m 3 (current-buffer))
    (= (marker-position m) 3)))

; marker-buffer returns non-nil for set marker
(with-temp-buffer
  (insert "hello")
  (let ((m (make-marker)))
    (set-marker m 3 (current-buffer))
    (not (null (marker-buffer m)))))

; marker-insertion-type / set-marker-insertion-type
(let ((m (make-marker)))
  (eq (marker-insertion-type m) nil))
(let ((m (make-marker)))
  (set-marker-insertion-type m t)
  (eq (marker-insertion-type m) t))

; set-marker to nil detaches
(with-temp-buffer
  (insert "hello")
  (let ((m (make-marker)))
    (set-marker m 3 (current-buffer))
    (set-marker m nil)
    (eq (marker-position m) nil)))

; error paths
(condition-case err (marker-position 42) (error (car err)))
(condition-case err (marker-buffer 42) (error (car err)))
