(fboundp 'command-remapping)
(subr-arity (symbol-function 'command-remapping))

(let ((g (make-sparse-keymap))
      (l (make-sparse-keymap)))
  (use-global-map g)
  (use-local-map l)
  (define-key l [remap ignore] 'self-insert-command)
  (command-remapping 'ignore))

(let ((g (make-sparse-keymap))
      (l (make-sparse-keymap)))
  (use-global-map g)
  (use-local-map l)
  (define-key l [remap ignore] 'self-insert-command)
  (command-remapping 'ignore nil nil))

(let ((g (make-sparse-keymap))
      (l (make-sparse-keymap)))
  (use-global-map g)
  (use-local-map l)
  (define-key g [remap ignore] 'forward-char)
  (define-key l [remap ignore] 'self-insert-command)
  (command-remapping 'ignore))

(let ((g (make-sparse-keymap))
      (l (make-sparse-keymap)))
  (use-global-map g)
  (use-local-map l)
  (define-key g [remap ignore] 'self-insert-command)
  (command-remapping 'ignore))

(with-temp-buffer
  (let ((g (make-sparse-keymap))
        (l (make-sparse-keymap)))
    (use-global-map g)
    (use-local-map l)
    (define-key l [remap ignore] 'self-insert-command)
    (command-remapping 'ignore (point-min))))

(let ((g (make-sparse-keymap))
      (l (make-sparse-keymap))
      (m (make-sparse-keymap)))
  (use-global-map g)
  (use-local-map l)
  (define-key l [remap ignore] 'self-insert-command)
  (define-key m [remap ignore] 'forward-char)
  (command-remapping 'ignore nil m))
