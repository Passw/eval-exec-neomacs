; symbol-designator introspection parity for functionp/macrop/func-arity and alias resolution.
(let ((orig (symbol-function 't)))
  (unwind-protect
      (progn
        (fset t 'car)
        (functionp t))
    (fset 't orig)))

(let ((orig (symbol-function 't)))
  (unwind-protect
      (progn
        (fset t 'car)
        (func-arity t))
    (fset 't orig)))

(let ((orig-t (symbol-function 't))
      (orig-x (symbol-function 'vm-func-t)))
  (unwind-protect
      (progn
        (fset t 'car)
        (fset 'vm-func-t t)
        (indirect-function 'vm-func-t))
    (fset 't orig-t)
    (fset 'vm-func-t orig-x)))

(let ((orig-t (symbol-function 't))
      (orig-x (symbol-function 'vm-func-t)))
  (unwind-protect
      (progn
        (fset t 'car)
        (fset 'vm-func-t t)
        (func-arity 'vm-func-t))
    (fset 't orig-t)
    (fset 'vm-func-t orig-x)))

(let ((orig (symbol-function :vm-intro-k)))
  (unwind-protect
      (progn
        (fset :vm-intro-k 'car)
        (functionp :vm-intro-k))
    (fset :vm-intro-k orig)))

(let ((orig (symbol-function :vm-intro-k)))
  (unwind-protect
      (progn
        (fset :vm-intro-k 'car)
        (func-arity :vm-intro-k))
    (fset :vm-intro-k orig)))

(let ((orig (symbol-function :vm-intro-k)))
  (unwind-protect
      (progn
        (fset :vm-intro-k (symbol-function 'when))
        (macrop :vm-intro-k))
    (fset :vm-intro-k orig)))

(let ((orig (symbol-function :vm-intro-k)))
  (unwind-protect
      (progn
        (fset :vm-intro-k nil)
        (condition-case err (func-arity :vm-intro-k) (error err)))
    (fset :vm-intro-k orig)))

(let ((orig (symbol-function 'vm-fa-nil)))
  (unwind-protect
      (progn
        (fset 'vm-fa-nil nil)
        (condition-case err (func-arity 'vm-fa-nil) (error err)))
    (fset 'vm-fa-nil orig)))

(let ((orig (symbol-function 'vm-fp-alias)))
  (unwind-protect
      (progn
        (fset 'vm-fp-alias 'car)
        (functionp 'vm-fp-alias))
    (fset 'vm-fp-alias orig)))

(let ((orig (symbol-function 'vm-macro-alias)))
  (unwind-protect
      (progn
        (fset 'vm-macro-alias 'when)
        (macrop 'vm-macro-alias))
    (fset 'vm-macro-alias orig)))
