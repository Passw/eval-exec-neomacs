(list
 (let ((p (start-process "neo-contact-shape-real" nil "cat")))
   (unwind-protect
       (list
        (eq (process-contact p) t)
        (eq (process-contact p t) t)
        (eq (process-contact p nil t) t)
        (eq (process-contact p :foo) t))
     (ignore-errors (delete-process p))))
 (let ((p (make-network-process :name "neo-contact-shape-net" :server t :service 0)))
   (unwind-protect
       (let ((c0 (process-contact p))
             (ct (process-contact p t))
             (cn (process-contact p nil t))
             (cf (process-contact p :foo)))
         (list
          (and (listp c0) (= (length c0) 2) (null (car c0)) (integerp (cadr c0)))
          (and (listp ct)
               (stringp (plist-get ct :name))
               (eq (plist-get ct :server) t)
               (integerp (plist-get ct :service))
               (vectorp (plist-get ct :local)))
          (and (listp cn) (= (length cn) 2) (null (car cn)) (integerp (cadr cn)))
          (null cf)))
     (ignore-errors (delete-process p))))
 (let ((p (make-pipe-process :name "neo-contact-shape-pipe")))
   (unwind-protect
       (let ((c0 (process-contact p))
             (ct (process-contact p t))
             (cn (process-contact p nil t))
             (cf (process-contact p :foo)))
         (list
          (eq c0 t)
          (and (listp ct) (stringp (plist-get ct :name)))
          (eq cn t)
          (null cf)))
     (ignore-errors (delete-process p)))))
