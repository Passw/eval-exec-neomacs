; fns.c â€” base64 & crypto string operations

; base64-encode-string
(base64-encode-string "hello")
(base64-encode-string "")
(base64-encode-string "a")
(base64-encode-string "ab")
(base64-encode-string "abc")
(base64-encode-string "hello world, this is a test")
(base64-encode-string "hello" t)
(condition-case err (base64-encode-string 5) (error (car err)))

; base64-decode-string
(base64-decode-string (base64-encode-string "hello"))
(base64-decode-string "aGVsbG8=")
(base64-decode-string "")
(base64-decode-string "YQ==")
(condition-case err (base64-decode-string "!!!") (error (car err)))
(condition-case err (base64-decode-string 5) (error (car err)))

; base64url-encode-string
(base64url-encode-string "hello")
(base64url-encode-string "hello" t)
(base64url-encode-string "")
(base64url-encode-string "ab")

; secure-hash
(secure-hash 'sha256 "hello")
(secure-hash 'sha1 "hello")
(secure-hash 'sha224 "hello")
(secure-hash 'sha384 "hello")
(secure-hash 'sha512 "hello")
(secure-hash 'md5 "hello")
(secure-hash 'sha256 "")
(condition-case err (secure-hash 'unknown-algo "hello") (error (car err)))
(condition-case err (secure-hash 'sha256 5) (error (car err)))

; secure-hash-algorithms
(listp (secure-hash-algorithms))
(memq 'sha256 (secure-hash-algorithms))
(memq 'md5 (secure-hash-algorithms))

; buffer-hash
(with-temp-buffer (insert "test") (stringp (buffer-hash)))
(with-temp-buffer (stringp (buffer-hash)))
(with-temp-buffer (insert "abc") (equal (buffer-hash) (buffer-hash)))
